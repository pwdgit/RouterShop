<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RouterShop</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Internal styling for SVG alignment within headings and buttons */
        h1, h2, h3, .tab-btn, button {
            display: flex;
            align-items: center;
        }
        /* UXP Workaround: Using margin to simulate gap */
        h1 > *:not(:last-child), h2 > *:not(:last-child), h3 > *:not(:last-child), .tab-btn > *:not(:last-child), button > *:not(:last-child) {
            margin-right: 8px; /* Simulated gap between icon and text */
        }
        .ui-icon {
            width: 16px;
            height: 16px;
            flex-shrink: 0;
            fill: currentColor; /* Inherit color, which will be white for buttons */
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>
            <!-- Logo Image -->
            <img src="logo.png" alt="RouterShop Logo" class="ui-icon" style="width: 40px; height: 40px; flex-shrink: 0;">
            <span>RouterShop</span>
        </h1>

        <!-- Tab navigation -->
        <div class="tab-nav">
            <button class="tab-btn active" data-tab="main-tab">
                <!-- Generate Icon -->
                <svg class="ui-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10c1.38 0 2.69-.28 3.9-.78A8.51 8.51 0 0 1 12.5 10c0-4.42 3.58-8 8-8 .34 0 .67.02 1 .06.32-.97.5-2.02.5-3.12C22 3.83 17.67 2 12 2zm.5 13c-1.63 0-3.09.79-4 2 .91 1.21 2.37 2 4 2s3.09-.79 4-2c-.91-1.21-2.37-2-4-2z"/><path d="M18.5 4c-2.49 0-4.5 2.01-4.5 4.5S16.01 13 18.5 13s4.5-2.01 4.5-4.5S20.99 4 18.5 4zm0 6c-.83 0-1.5-.67-1.5-1.5S17.67 7 18.5 7s1.5.67 1.5 1.5S19.33 10 18.5 10z" /></svg>
                <span>Generate</span>
            </button>
            <button class="tab-btn" data-tab="settings-tab">
                <!-- Settings Icon -->
                <svg class="ui-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69-.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"/></svg>
                <span>Settings</span>
            </button>
        </div>

        <!-- Main Tab Content -->
        <div id="main-tab" class="tab-content" style="display:block;">

            <!-- Selection Tools Section -->
            <section class="section-card">
                <header class="section-header">
                    <!-- Selection Icon -->
                    <svg class="ui-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 16V4c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zm-8-3.5l-2.5 3.01L8.5 12l-3.5 4.5h12l-4-5.5z"/></svg>
                    <h2>Selection Tools</h2>
                </header>
                <div class="selection-controls">
                    <select id="aspect-ratio-select"></select>
                    <button id="add-selection-btn" class="secondary-btn">
                        <!-- Create Selection Icon (Add) -->
                        <svg class="ui-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 13h-5v5c0 .55-.45 1-1 1s-1-.45-1-1v-5H6c-.55 0-1-.45-1-1s.45-1 1-1h5V6c0-.55.45-1 1-1s1 .45 1 1v5h5c.55 0 1 .45 1 1s-.45 1-1 1z"/></svg>
                        <span>Create Selection</span>
                    </button>
                </div>
                <div id="status-selection" class="status-message"></div>

                <div class="scale-slider-container">
                    <div class="scale-header">
                        <span class="scale-title">Scale Selection</span>
                        <span id="scale-value" class="scale-value">0%</span>
                    </div>
                    <div class="scale-controls">
                        <span class="scale-label">Contract</span>
                        <input type="range" id="scale-slider" min="-50" max="50" value="0" step="1" class="scale-input">
                        <span class="scale-label">Expand</span>
                    </div>
                    <div id="status-modify" class="status-message"></div>
                </div>
            </section>

            <!-- Inpainting Section (Image-to-Image) -->
            <section class="section-card section-compact">
                <header class="section-header section-header-compact">
                    <!-- Inpainting Icon (Paint Brush) -->
                    <svg class="ui-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.06 9.02l.92.92L5.83 19H5v-.83L14.06 9.02M17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29zm-3.6 3.19L3 17.25V21h3.75L17.81 9.94l-3.75-3.75z"/></svg>
                    <h2>Inpainting (Image-to-Image)</h2>
                </header>

                <div class="prompt-wrapper">
                    <textarea id="prompt-img2img" placeholder="Describe how to transform the selected area... (e.g., 'add a red dragon on the rock')" rows="8"></textarea>

                    <div class="prompt-action-bar">
                        <label class="toggle-switch" title="Include Image Context">
                            <input type="checkbox" id="image-context-img2img-checkbox" checked>
                            <span class="toggle-slider"></span>
                            <!-- Context Icon (Image) -->
                            <svg class="toggle-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg>
                            <span class="toggle-label">Context</span>
                        </label>
                        <button id="optimize-prompt-img2img-btn" class="icon-btn tertiary-btn" title="Optimize Prompt">
                            ✨
                        </button>
                    </div>
                </div>
                <button id="img2img-btn" class="secondary-btn">
                    <!-- Generate Icon (Small version) -->
                    <svg class="ui-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10c1.38 0 2.69-.28 3.9-.78A8.51 8.51 0 0 1 12.5 10c0-4.42 3.58-8 8-8 .34 0 .67.02 1 .06.32-.97.5-2.02.5-3.12C22 3.83 17.67 2 12 2zm.5 13c-1.63 0-3.09.79-4 2 .91 1.21 2.37 2 4 2s3.09-.79 4-2c-.91-1.21-2.37-2-4-2z"/><path d="M18.5 4c-2.49 0-4.5 2.01-4.5 4.5S16.01 13 18.5 13s4.5-2.01 4.5-4.5S20.99 4 18.5 4zm0 6c-.83 0-1.5-.67-1.5-1.5S17.67 7 18.5 7s1.5.67 1.5 1.5S19.33 10 18.5 10z" /></svg>
                    <span>Generate Inpainting</span>
                </button>
                <div id="status-img2img" class="status-message"></div>
            </section>

            <!-- Text-to-Image Section -->
            <section class="section-card section-compact">
                <header class="section-header section-header-compact">
                    <!-- Text-to-Image Icon (Text/Image) -->
                    <svg class="ui-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 2H9v2h6V2zM7 2v2H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-1V2h-2v2H9V2H7zm11 15H6V8h12v9zM8 10h2v6H8v-6zm4 0h2v6h-2v-6z"/></svg>
                    <h2>Text-to-Image Generation</h2>
                </header>
                <div class="selection-controls" style="margin-bottom: var(--sp-3);">
                    <label style="margin-bottom: 0;">Output Size</label>
                    <select id="image-size-select" style="flex-grow: 1;"></select>
                </div>
                <div class="prompt-wrapper">
                    <textarea id="prompt" placeholder="Describe the image you want to create... (e.g., 'a serene mountain landscape at sunset')" rows="8"></textarea>

                    <div class="prompt-action-bar">
                        <label class="toggle-switch" title="Include Image Context (will be used as ControlNet input)">
                            <input type="checkbox" id="image-context-checkbox">
                            <span class="toggle-slider"></span>
                            <!-- Context Icon (Image) -->
                            <svg class="toggle-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg>
                            <span class="toggle-label">Context</span>
                        </label>
                        <button id="optimize-prompt-btn" class="icon-btn tertiary-btn" title="Optimize Prompt">
                            
                            ✨
                        </button>
                    </div>
                </div>
                <button id="generate-btn" class="secondary-btn">
                    <!-- Generate & Add Layer Icon -->
                    <svg class="ui-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 11c.55 0 1 .45 1 1v2.23c.36.11.7.27 1 .48V11c0-2.21-1.79-4-4-4s-4 1.79-4 4v3.71c.3.21.64.37 1 .48V12c0-.55.45-1 1-1h2zm-4 2v.7c0 1.8 1.45 3.29 3.26 3.29H12c2.21 0 4-1.79 4-4v-1h-2v1c0 1.1-.9 2-2 2s-2-.9-2-2v-1h-2zM4.14 13.14l-1.9-1.9c-.31-.31-.31-.82 0-1.13L4.14 8.2a.807.807 0 0 1 1.13 0l1.9 1.9c.31.31.31.82 0 1.13l-1.9 1.9c-.31.31-.82.31-1.13 0zM12 1L9 4h6l-3-3z"/></svg>
                    <span>Generate & Add Layer</span>
                </button>
                <div id="status" class="status-message"></div>
            </section>
        </div>

        <!-- Settings Tab Content -->
        <div id="settings-tab" class="tab-content">
            <section class="section-card">
                <header class="section-header">
                    <!-- API Icon (Key) -->
                    <svg class="ui-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12.65 10A5.99 5.99 0 0 0 7 6c-3.31 0-6 2.69-6 6s2.69 6 6 6c3.31 0 6-2.69 6-6 0-.39-.04-.78-.11-1.16l1.46-1.46c.39-.39.39-1.02 0-1.41L12.65 10zM7 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm14.37-6.37c-.39-.39-1.02-.39-1.41 0L18.9 10.7l-2.12-2.12 1.06-1.06c.39-.39.39-1.02 0-1.41s-1.02-.39-1.41 0l-1.06 1.06-2.12-2.12 1.06-1.06c.39-.39.39-1.02 0-1.41s-1.02-.39-1.41 0L12 5.12 9.88 3H12V1H8v4h2v-1.88l2.12 2.12-1.06 1.06c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0l1.06-1.06 2.12 2.12-1.06 1.06c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0l1.06-1.06 2.12 2.12-6.18 6.18H10v-2H8v4h4v-2h2.12l6.37-6.37c.39-.39.39-1.02 0-1.41l-2.12-2.12z"/></svg>
                    <h3>API Configuration</h3>
                </header>
                <div class="setting-row">
                    <label for="openrouter-api-key-input">OpenRouter API Key</label>
                    <div class="input-with-button">
                        <input type="password" id="openrouter-api-key-input" placeholder="sk-or-v1-...">
                        <button id="toggle-api-key-visibility" class="icon-btn tertiary-btn" title="Toggle Visibility" style="width: auto; padding: 0 8px;">
                            <!-- Toggle Visibility Icon (Eye) -->
                            <svg class="ui-icon icon-eye" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
                            <!-- Toggle Visibility Icon (Eye Off) -->
                            <svg class="ui-icon icon-eye-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="display:none;"><path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.44-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/></svg>
                        </button>
                    </div>
                </div>
                <div class="setting-row">
                    <button id="check-api-status-btn" class="secondary-btn">
                        <!-- Check Status Icon (Clipboard/List) -->
                        <svg class="ui-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16 6H4c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V8h12v10zM8 10h2v6H8v-6zm4 0h2v6h-2v-6z"/><path d="M20 4h-2v14h2V4z" /></svg>
                        <span>Check API Status</span>
                    </button>
                    <div id="api-status-display-box" class="status-box">
                        <div class="status-grid">
                            <div class="status-row">
                                <span class="status-label">Status:</span>
                                <span class="status-value" id="api-status">-</span>
                            </div>
                            <div class="status-row">
                                <span class="status-label">Limit:</span>
                                <span class="status-value" id="api-limit">-</span>
                            </div>
                            <div class="status-row">
                                <span class="status-label">Usage:</span>
                                <span class="status-value" id="api-usage">-</span>
                            </div>
                            <div class="status-row">
                                <span class="status-label">Remaining:</span>
                                <span class="status-value" id="api-remaining">-</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="section-card">
                <header class="section-header">
                    <!-- Model Icon (Info/Circle) -->
                    <svg class="ui-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-12h2v2h-2v-2zm0 4h2v4h-2v-4z"/></svg>
                    <h3>Model Settings</h3>
                </header>
                <!-- Reduced margin/padding for closer placement -->
                <div class="setting-row compact"><label for="setting-text-model">Text Model</label><input type="text" id="setting-text-model" value="google/gemini-2.5-flash"></div>
                <div class="setting-row compact"><label for="setting-vision-model">Vision Model</label><input type="text" id="setting-vision-model" value="google/gemini-2.5-flash"></div>
                <div class="setting-row compact"><label for="setting-image-model">Image Generation Model</label><input type="text" id="setting-image-model" value="google/gemini-2.5-flash-image-preview"></div>
            </section>

            <section class="section-card">
                <header class="section-header">
                    <!-- Optimizer Icon -->
                    <svg class="ui-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2.5a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0V3.25A.75.75 0 0 1 12 2.5ZM17.636 4.864a.75.75 0 0 1 1.06 0l2.475 2.475a.75.75 0 0 1 0 1.06l-2.475 2.475a.75.75 0 0 1-1.06-1.06L19.04 7.5l-1.404-1.404a.75.75 0 0 1 0-1.06ZM2.5 12a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 0 1.5H3.25A.75.75 0 0 1 2.5 12ZM12 21.5a.75.75 0 0 1-.75-.75v-3.5a.75.75 0 0 1 1.5 0v3.25a.75.75 0 0 1-.75.75ZM4.864 17.636a.75.75 0 0 1 0-1.06l1.404-1.404L4.864 13.77a.75.75 0 0 1-1.06-1.06l2.475-2.475a.75.75 0 0 1 1.06 0l2.475 2.475a.75.75 0 0 1 0 1.06L7.34 16.23l1.404 1.404a.75.75 0 0 1-1.06 1.06L4.864 17.636ZM21.5 12a.75.75 0 0 1-.75.75h-3.5a.75.75 0 0 1 0-1.5h3.25a.75.75 0 0 1 .75.75ZM13.77 4.864a.75.75 0 0 1 1.06 0l2.475 2.475a.75.75 0 0 1 0 1.06l-2.475 2.475a.75.75 0 0 1-1.06-1.06L15.176 8.41l-1.404-1.404a.75.75 0 0 1 0-1.06Z" /></svg>
                    <h3>Prompt Optimizer</h3>
                </header>
                <div class="setting-row compact">
                    <label for="setting-optimizer-prompt">System Prompt for Optimization</label>
                    <textarea id="setting-optimizer-prompt" rows="3" placeholder="You are an expert prompt engineer..."></textarea>
                </div>
            </section>

            <section class="section-card section-last">
                <header class="section-header">
                    <!-- Backup Icon -->
                    <svg class="ui-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/></svg>
                    <h3>Settings Backup</h3>
                </header>
                <div id="settings-status-message" class="status-message"></div>
                <div class="import-export-buttons">
                    <button id="export-settings-btn" class="secondary-btn">
                        <!-- Export Icon -->
                        <svg class="ui-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 10v6h14v-6H5zm-2-2h18v10H3V8zM12 12.5L10.5 14l3.5 3.5 3.5-3.5L16 12.5l-2.5 2.5V8h-3v7l-2.5-2.5z"/></svg>
                        <span>Export Settings</span>
                    </button>
                    <button id="import-settings-btn" class="secondary-btn">
                        <!-- Import Icon -->
                        <svg class="ui-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
                        <span>Import Settings</span>
                    </button>
                <input type="file" id="import-settings-file" style="display:none;" accept=".json">
            </section>
        </div>
    </div>

    <script src="index.js"></script>
</body>
</html>